# 独立三方应用发布系统 - 产品需求文档 (PRD v3.0)

## 1. 系统概述

### 1.1 产品定位
帮助开发者将应用发布到第三方应用商店的管理系统

### 1.2 核心流程 (7大节点)
1. 通道发布申请 → 2. 通道发布审核 → 3. 物料上传 → 4. 物料审核 → 5. 应用上架 → 6. 业务内测 → 7. 灰度监控

---

## 2. 流程单详情页面

### 2.1 基础信息展示
- 流程单ID、名称、创建时间等

### 2.2 应用卡片列表
以卡片形式展示该流程单需要发布的独立应用

**卡片内容**:
- 应用图标
- 应用名字
- 应用包名
- 应用类型
- 应用版本号（通道发布申请时填写）
- 应用流程节点
- 应用流程节点状态
- 操作人
- 拒绝原因（被后续节点拒绝回退时显示）
- 创建时间

**功能**:
- 支持搜索（按应用名字/包名）
- 支持分页
- 点击卡片上方"添加"按钮 → 弹出添加Modal框

### 2.3 添加应用Modal
- 显示可添加的应用列表（图标、名字、包名、类型）
- 支持搜索
- 已存在的应用不可选择
- 确认后添加到卡片列表

---

## 3. 单APK发布流程详情

点击应用卡片，跳转打开单APK的发布流程详情界面，分为三块：

### 3.1 APK基本信息
| 字段 | 说明 |
|------|------|
| 应用图标 | 图片 |
| 应用名字 | 文本 |
| 应用包名 | 文本 |
| 应用版本号 | 通道发布申请时填写 |
| 状态 | 进行中(蓝色)/已完成(绿色)/失败(红色) |

**状态逻辑**:
- 有一个子节点正在进行 → 进行中(蓝色)
- 所有子节点都完成 → 已完成(绿色)
- 有一个子节点拒绝 → 失败(红色)

### 3.2 流水线
- 7大节点可视化展示
- 成功=绿色，拒绝=红色，进行中=蓝色
- 点击节点打开对应的Modal框

**节点Modal规则**:
- 成功的节点 → 只可查看，不可编辑
- 进行中的节点 → 可编辑
- 拒绝的节点 → 可编辑，显示拒绝原因

### 3.3 历史操作记录
| 字段 | 说明 |
|------|------|
| 操作时间 | 时间戳 |
| 操作人 | 用户名 |
| 操作动作 | 节点扭转/审核通过/审核拒绝 |
| 操作详情 | 拒绝原因等 |

---

## 4. 节点详情Modal

### 4.1 通道发布申请 (责任人: 添加该应用的人)

**Modal结构**:
1. 基础信息 (全部必填)
2. 所需物料 (非必填)
3. 是否PA应用更新

**基础信息字段**:
| 字段 | 类型 | 说明 |
|------|------|------|
| 应用名称 | 自动带出 | 不可编辑 |
| 应用包名 | 自动带出 | 不可编辑 |
| 应用类型 | 自动带出 | 不可编辑 |
| 应用版本号 | 下拉选择 | 可搜索，枚举为APK版本 |
| 应用APK | 自动带出 | 根据版本号带出 |
| 应用测试PASS报告 | 附件上传 | - |
| 应用分类 | 下拉单选 | 可搜索，固定枚举 |
| 系统应用 | radio | 是/否 |
| 发布国家 | 条件选择 | 类型(全部/包含/不包含)+多选 |
| 发布品牌 | 条件选择 | 类型+多选，枚举:Tecno,Infinix,itel |
| 发布机型 | 条件选择 | 类型+多选 |
| 内测机型 | 条件选择 | 类型+多选 |
| 适用安卓版本 | 条件选择 | 类型+多选 |
| 适用tOS版本 | 条件选择 | 根据安卓版本筛选 |
| 是否需要过滤印度 | radio | 是/否 |

**所需物料字段** (按语言Tab切换):
- 默认英语(不可删除)，可添加: 俄语/葡萄牙语/西班牙语/阿语/韩语
- 应用名称
- 一句话描述
- 产品详情
- 更新说明
- 关键词 (下拉多选，1-5个)
- 应用图标 (图片，1:1，≥180x180px)
- 置顶大图 (图片，1080x594px，≤2MB)
- 详情截图 (3-5张，竖480x854/横854x480)
- 是否GP上架 (是/否，选择是时需填写GP链接)

**是否PA应用更新**:
- radio: 是/否 (默认是)
- 选择是时: 灰度量级(1-100000)、生效时间

**操作**:
- 实时保存
- 取消: 关闭弹窗
- 确认: 扭转到通道发布审核节点，飞书通知审核人

---

### 4.2 通道发布审核 (责任人: 暂定)

**Modal结构**:
1. 审核结果 (通过/不通过) - 固定在最上方
2. 通道发布详情 (申请填写的内容，只读)

**审核流程**:
- 通过 → 扭转到物料上传节点，飞书通知
- 不通过 → 填写理由，扭转到通道发布申请节点，显示拒绝原因

---

### 4.3 物料上传 (责任人: 初始化为通道发布申请责任人)

**Modal结构**: 同通道发布申请，但所有字段为必填

**操作**:
- 确认 → 扭转到物料审核节点，飞书通知

---

### 4.4 物料审核 (责任人: 暂定)

**Modal结构**:
1. 运营人员审核结果 (通过/不通过) - 固定最上方
2. 老板审核结果 (通过/不通过) - 仅在运营通过后填写
3. 物料上传详情 (只读)

**审核流程**:
1. 运营人员审核
2. 运营通过 → 通知老板审核
3. 老板通过 → 扭转到应用上架节点
4. 任一拒绝 → 扭转到物料上传节点，显示拒绝原因

---

### 4.5 应用上架 (责任人: 暂定)

**数据来源**: 第三方平台

**展示字段**:
状态、生效中/已停用、应用名称、升级任务名称、应用包名、发布国家、品牌、机型、语言、安卓版本号、tOS版本、灰度量级、分类、生效时间

---

### 4.6 业务内测 (责任人: 暂定)

**数据来源**: 第三方平台

**展示字段**: 同应用上架

**特殊**: 收到拒绝消息 → 扭转到物料上传节点，显示拒绝原因

---

### 4.7 灰度监控 (责任人: 暂定)

**数据来源**: 第三方平台

**展示字段**:
应用名称、应用包名、任务名称、生效时间、灰度量级、现状/总计、状态(进行中/已停用)、创建时间

---

## 5. 枚举值

### 应用分类
Travel & Local, Shopping, Entertainment, Finance, Business, Weather, Social, Education, Medical, Auto & Vehicles

### 发布品牌
Tecno, Infinix, itel

### 发布机型
X6841_H6941, X6858_H8917(Android 16), KO5_H8925, ...

### 适用安卓版本
Android 11, 12, 13, 14, 15, 16

### 适用tOS版本
根据安卓版本筛选: tOS 16.1.0, tOS 15.2.0, ...

---

## 6. 状态显示

| 状态 | 颜色 | 说明 |
|------|------|------|
| 进行中 | 蓝色 | 有节点在进行 |
| 已完成 | 绿色 | 所有节点完成 |
| 失败 | 红色 | 有节点拒绝 |

---

*最后更新: 2026-03-01*
*版本: v3.0*
