# 独立三方应用发布系统 - 产品需求文档 (PRD)

## 项目概述
**项目名称**: 独立三方应用发布系统  
**在线地址**: https://frontend-wine-one-87.vercel.app

---

## 1. 主页

### 1.1 独立三方应用发布流程申请列表
**筛选/搜索字段** (必须全部实现):
- 班车名称 (格式: 班车 YYYY-MM-DD HH:mm:ss)
- tOS版本 (格式: tOS 16.1.0)
- APK状态 (成功=绿色 / 拒绝=红色 / 进行中=蓝色 / 总数=黑色)
- 申请人
- 申请时间

**操作**:
- 点击"查看详情" → 打开流程单详情页
- 点击"申请"按钮 → 弹出Modal框填写班车信息创建流程单

### 1.2 待办 (TODO)
**卡片内容**:
- 班车名称
- 应用名称
- 应用的流程节点
- 应用的流程节点状态
- 处理人
- 操作按钮: "去处理"
- 拒绝原因 (当被后续节点拒绝回退时显示)

**交互**: 点击"去处理" → 跳转至对应申请详情中对应APK的流程详情，打开对应节点的操作Modal

### 1.3 看板 (Kanban)
**班车视角**:
- 班车1: x月; 覆盖xx、xx、xx等x个产品
- 班车2: x月; 覆盖xx、xx、xx等x个产品

**产品视角**:
- 产品1: 发布x次 (点击进入每次的形态)
- 产品2: 发布x次 (点击进入每次的形态)

**状态视角**:
- 进行中: x个产品
- 已完成: x个产品, x次升级任务

---

## 2. 独立三方应用发布流程单详情

### 2.1 基础信息
展示该流程单的基础信息

### 2.2 应用卡片列表
- 以卡片形式展示该流程需要发布的独立应用
- **卡片内容**: 应用图标、应用名字、应用包名、应用类型、应用版本号、流程节点、流程节点状态、操作人、拒绝原因、创建时间
- **支持搜索和分页**
- **添加应用**: 点击添加按钮弹出Modal框，显示可添加的应用列表（应用图标、应用名字、应用包名、应用类型），支持搜索，外面已存在的应用不能选择

### 2.3 单APK发布流程详情 (点击卡片打开)

#### 2.3.1 APK基本信息
- 应用图标、应用名字、应用包名、应用版本号
- 状态: 
  - 进行中(蓝色) - 有一个子节点正在进行
  - 已完成(绿色) - 所有子节点都完成
  - 失败(红色) - 有一个子节点拒绝

#### 2.3.2 流水线 (7大节点)
- 通道发布申请 → 通道发布审核 → 物料上传 → 物料审核 → 应用上架 → 业务内测 → 灰度监控
- 节点样式: 成功=绿色 / 拒绝=红色 / 进行中=蓝色
- 点击节点打开对应的Modal框
  - 成功的节点: 只可查看不可编辑
  - 进行中的节点: 用户可编辑
  - 拒绝的节点: 可编辑，并显示拒绝原因

#### 2.3.3 历史操作记录
- 操作时间、操作人、操作动作、操作详情(如拒绝原因)

---

## 3. 7大节点详细流程

### 通道发布申请
**责任人**: 添加该应用的人

**Modal表单 - 基础信息** (必填):
| 字段 | 类型 | 说明 |
|------|------|------|
| 应用名称 | 自动带出 | 不可编辑 |
| 应用包名 | 自动带出 | 不可编辑 |
| 应用类型 | 自动带出 | 不可编辑 |
| 应用版本号 | 下拉单选可搜索 | 通过应用发布系统获取APK版本 |
| 应用APK | 下拉选择 | 带出制品地址 |
| 应用测试PASS报告 | 附件上传 | |
| 应用分类 | 下拉单选可搜索 | Travel & Local, Shopping, Entertainment, Finance, Business, Weather, Social, Education, Medical, Auto & Vehicles |
| 系统应用 | radio | 是/否 |
| 发布国家 | 多级选择 | 类型:全部/包含/不包含 + 多选国家 |
| 发布品牌 | 多级选择 | 类型:全部/包含/不包含 + 多选品牌 (Tecno, Infinix, itel) |
| 发布机型 | 多级选择 | 类型:全部/包含/不包含 + 多选机型 |
| 内测机型 | 多级选择 | 类型:全部/包含/不包含 + 多选机型 |
| 适用安卓版本 | 多级选择 | 类型:全部/包含/不包含 + 多选 (Android 11-16) |
| 适用tOS版本 | 多级选择 | 类型:全部/包含/不包含 + 多选 (根据安卓版本筛选) |
| 是否过滤印度 | radio | 是/否 |

**Modal表单 - 所需物料** (非必填):
- 语言Tab切换: 默认英语(不可删) + 俄语/葡萄牙语/西班牙语/阿语/韩语...
- 每种语言字段:
  - 应用名称 (文本)
  - 一句话描述 (多行)
  - 产品详情 (多行)
  - 更新说明 (多行)
  - 关键词 (下拉多选1-5个)
  - 应用图标 (图片 1:1, ≥180x180px)
  - 置顶大图 (图片 1080x594px, ≤2MB)
  - 详情截图 (图片 3-5张, ≤2MB/张, 竖480x854/横854x480)
  - 是否GP上架 (radio 是/否) + GP链接(如果选是)

**Modal表单 - PA应用更新**:
| 字段 | 类型 | 说明 |
|------|------|------|
| 是否PA应用更新 | radio | 默认是 |
| 灰度量级 | 数字范围 | 1-100000/天 (如果选是) |
| 生效时间 | 时间范围 | (如果选是) |

**操作**:
- 实时保存
- 点击取消关闭
- 点击确认 → 扭转到通道发布审核节点 → 飞书通知审核责任人

---

### 通道发布审核
**责任人**: 暂定

**Modal表单**:
- 审核结果: 通过/不通过 (单选)
- 不通过理由 (多行文本, 当选不通过时显示)

**审核详情**: 展示通道发布申请填写的所有内容 (不可编辑)

**操作**:
- 实时保存
- 点击取消关闭
- 选通过 → 确认 → 扭转到物料上传节点 → 飞书通知
- 选不通过 → 填写理由 → 确认 → 扭转到通道发布申请节点 → 显示拒绝状态和原因 → 飞书通知

---

### 物料上传
**责任人**: 初始化为通道发布申请的责任人

**Modal表单字段**: 与通道发布申请完全一致，但**全部为必填**

**操作**:
- 实时保存
- 点击取消关闭
- 点击确认 → 扭转到物料审核节点 → 飞书通知审核责任人

---

### 物料审核
**责任人**: 运营人员 + 老板 (双重审核)

**Modal表单**:
- 运营人员审核结果: 通过/不通过 (单选)
- 不通过理由 (多行)
- 老板审核结果: 通过/不通过 (单选, 运营通过后才可填)
- 不通过理由 (多行)

**物料详情**: 展示物料上传填写的所有内容 (不可编辑)

**操作**:
- 实时保存
- 运营选通过 → 通知老板审核
- 运营选不通过 → 扭转到物料上传节点 → 显示拒绝状态和原因 → 飞书通知
- 老板选通过 → 扭转到应用上架节点 → 飞书通知
- 老板选不通过 → 扭转到物料上传节点 → 显示拒绝状态和原因 → 飞书通知

---

### 应用上架
**责任人**: 暂定

**数据来源**: 其他平台

**展示字段**:
- 状态: 生效中 / 已停用
- 应用名称
- 升级任务名称
- 应用包名
- 发布国家
- 品牌
- 机型
- 语言
- 安卓版本号
- tOS版本
- 灰度量级
- 分类
- 生效时间: yyyy/mm/dd - yyyy/mm/dd

**特殊处理**: 被业务内测拒绝后二次走到应用上架 → 刷新原有单据显示最新数据

---

### 业务内测
**责任人**: 暂定

**数据来源**: 其他平台

**展示字段**:
- 状态: 生效中 / 已停用
- 应用名称
- 升级任务名称
- 应用包名
- 发布国家
- 品牌
- 机型
- 语言
- 安卓版本号
- tOS版本
- 灰度量级
- 分类
- 生效时间

**特殊处理**: 收到其他平台拒绝消息 → 飞书通知通道申请责任人 → 扭转到物料上传节点 → 显示拒绝状态和原因

---

### 灰度监控
**责任人**: 暂定

**数据来源**: 其他平台

**展示字段**:
- 应用名称
- 应用包名
- 任务名称
- 生效时间
- 灰度量级: xx/xx
- 现状/总计
- 状态: 已停用 / 进行中
- 创建时间

---

## 4. 字段枚举

### 应用分类
Travel & Local, Shopping, Entertainment, Finance, Business, Weather, Social, Education, Medical, Auto & Vehicles

### 发布品牌
Tecno, Infinix, itel

### 发布机型/内测机型
X6841_H6941, X6858_H8917(Android 16), KO5_H8925, ...

### 适用安卓版本
Android 11, Android 12, Android 13, Android 14, Android 15, Android 16

### 适用tOS版本
根据安卓版本筛选: tOS 16.1.0, tOS 15.2.0, ...

### 关键词
按语言区分，每个语言有对应的热词枚举

---

**文档版本**: v2.0 (详细版)  
**更新时间**: 2026-03-01
